<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Center Car — Εκτελωνισμοί</title>
  <style>
    :root{
      --bg:#0b1220; --panel:#0e1526; --card:#0f1a2f; --line:#1b2a45;
      --ink:#e6edf6; --muted:#9db1cf; --blue:#3b82f6; --ok:#10b981; --danger:#ef4444;
      --chip:#15203a; --chipOn:#1e3a8a;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);
      font:15px/1.5 -apple-system,system-ui,Segoe UI,Roboto,Inter,Arial}
    header{position:sticky;top:0;z-index:20;background:#0a1020;
      border-bottom:1px solid var(--line);padding:12px 16px;display:flex;justify-content:space-between;align-items:center;gap:10px}
    h1{margin:0;font-size:18px}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:14px}
    .row{display:grid;grid-template-columns:repeat(12,1fr);gap:10px}
    .c12{grid-column:span 12}.c8{grid-column:span 8}.c6{grid-column:span 6}.c4{grid-column:span 4}.c3{grid-column:span 3}
    @media(max-width:760px){.row{grid-template-columns:repeat(6,1fr)} .c8,.c6,.c4,.c3,.c12{grid-column:span 6}}
    label{display:block;font-size:12px;color:var(--muted);margin:6px 0 6px}
    input,select{width:100%;height:42px;border:1px solid var(--line);border-radius:10px;
      background:#0d162b;color:var(--ink);padding:0 12px;font-size:15px}
    input::placeholder{color:#7f93b2}
    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip{background:var(--chip);border:1px solid var(--line);border-radius:999px;padding:8px 12px;cursor:pointer;user-select:none}
    .chip.on{background:var(--chipOn);border-color:transparent}
    .btn{border:1px solid var(--line);background:#0d162b;color:var(--ink);border-radius:10px;padding:10px 14px;cursor:pointer;font-weight:700}
    .primary{background:var(--blue);border-color:var(--blue)}
    .ok{background:var(--ok);border-color:var(--ok)}
    .danger{background:var(--danger);border-color:var(--danger)}
    .ghost{background:#0d162b}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap}
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .tab{border:1px solid var(--line);background:#0d162b;color:var(--ink);padding:8px 12px;border-radius:999px;cursor:pointer}
    .tab.active{background:var(--blue);border-color:var(--blue)}
    .list{display:flex;flex-direction:column;gap:12px}
    .item{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px}
    .head{display:flex;gap:10px;justify-content:space-between;align-items:flex-start}
    .title{font-weight:800;font-size:18px}
    .badges{display:flex;flex-wrap:wrap;gap:6px;margin-top:6px}
    .badge{border:1px solid var(--line);border-radius:999px;padding:4px 8px;font-size:12px;color:#9fb7da}
    .muted{color:var(--muted);font-size:12px}
    .sep{height:1px;background:var(--line);margin:10px 0}
    .cfg{display:none;margin-bottom:12px}
    .cfg.show{display:block}
    .cfg .row input{background:#0d162b}
  </style>
</head>
<body>
<header>
  <h1>Center Car — Εκτελωνισμοί</h1>
  <div class="toolbar">
    <button id="cfgBtn" class="btn">CFG</button>
  </div>
</header>
<div class="wrap">

  <!-- CFG Panel (ανοίγει με το κουμπί ή ?cfg=1) -->
  <div class="card cfg" id="cfgPanel">
    <div style="font-weight:700;margin-bottom:6px">Ρυθμίσεις Υπολογισμού (CFG)</div>
    <div class="row">
      <div class="c3"><label>Base % Euro 6</label><input id="cfg_e6" type="number" step="0.001"></div>
      <div class="c3"><label>Base % Euro 5</label><input id="cfg_e5" type="number" step="0.001"></div>
      <div class="c3"><label>Base % Euro 4</label><input id="cfg_e4" type="number" step="0.001"></div>
      <div class="c3"><label>CO₂ κατώφλι</label><input id="cfg_floor" type="number"></div>
      <div class="c3"><label>€/g πάνω από κατώφλι</label><input id="cfg_rate" type="number"></div>
      <div class="c3"><label>MHEV factor</label><input id="cfg_mhev" type="number" step="0.01"></div>
      <div class="c3"><label>PHEV factor</label><input id="cfg_phev" type="number" step="0.01"></div>
      <div class="c3"><label>Fuel factor (Petrol)</label><input id="cfg_petrol" type="number" step="0.01"></div>
      <div class="c3"><label>Fuel factor (Diesel)</label><input id="cfg_diesel" type="number" step="0.01"></div>
      <div class="c3"><label>Μείωση/έτος</label><input id="cfg_age" type="number" step="0.01"></div>
      <div class="c3"><label>Uplift (→ προ φόρων)</label><input id="cfg_uplift" type="number" step="0.01"></div>
      <div class="c3"><label>Κατηγορία M1 factor</label><input id="cfg_m1" type="number" step="0.01"></div>
      <div class="c3"><label>Κατηγορία N1 factor</label><input id="cfg_n1" type="number" step="0.01"></div>
      <div class="c3"><label>Περιβαλλοντικό τέλος Euro 5 (€)</label><input id="cfg_env5" type="number" step="1"></div>
    </div>
    <div class="toolbar" style="margin-top:8px">
      <button id="cfgSave" class="btn ok">Αποθήκευση CFG</button>
      <button id="cfgReset" class="btn">Επαναφορά</button>
      <button id="cfgBack" class="btn">Πίσω</button>
      <span class="muted">Μόνο τελωνείο (χωρίς ΕΦΚ/ΦΠΑ/150€ εκτελωνιστή).</span>
    </div>
  </div>

  <!-- Tabs + αναζήτηση + export -->
  <div class="toolbar" style="justify-content:space-between;margin-bottom:10px">
    <div class="tabs">
      <button class="tab active" data-tab="all">Όλα</button>
      <button class="tab" data-tab="open">Ανοιχτά</button>
      <button class="tab" data-tab="locked">Κλειδωμένα</button>
    </div>
    <div class="toolbar">
      <input id="search" placeholder="Αναζήτηση (Μοντέλο / VIN)" style="max-width:300px">
      <button id="exportLocked" class="btn">Export Golden Cases</button>
      <button id="openCfg" class="btn">CFG</button>
    </div>
  </div>

  <!-- Φόρμα -->
  <div class="card" id="formCard">
    <div class="row">
      <div class="c6"><label>Μάρκα/Μοντέλο</label><input id="makeModel" placeholder="π.χ. BMW M440d xDrive Coupé"></div>
      <div class="c6"><label>VIN</label><input id="vin" placeholder="π.χ. WBA..."></div>

      <div class="c3"><label>Euro</label><select id="euro"><option>Euro 6</option><option>Euro 5</option><option>Euro 4</option></select></div>
      <div class="c3"><label>CO₂ (V7)</label><input id="co2" type="number" placeholder="π.χ. 139"></div>
      <div class="c3"><label>Κυβικά (cc)</label><input id="cc" type="number" placeholder="π.χ. 1995"></div>
      <div class="c3"><label>Χιλιόμετρα</label><input id="km" type="number" placeholder="π.χ. 70000"></div>

      <div class="c4"><label>Τιμή Τιμολογίου (€)</label><input id="purchase" type="number" inputmode="decimal" placeholder="π.χ. 49990"></div>
      <div class="c4"><label>Λιανική προ Φόρων (προαιρετικό)</label><input id="pretax" type="number" inputmode="decimal" placeholder="αν τη ξέρεις, βάλ’ τη εδώ"></div>
      <div class="c4"><label>Παράγραφος 25a</label><select id="para"><option value="yes">Ναι (χωρίς ΦΠΑ)</option><option value="no">Όχι</option></select></div>

      <div class="c6"><label>Ημερομηνία Παραγωγής</label><input id="prodDate" type="date"></div>
      <div class="c6"><label>Κατηγορία Οχήματος</label>
        <div id="catChips" class="chips">
          <div class="chip on" data-cat="M1">M1 (επιβατικό)</div>
          <div class="chip" data-cat="N1">N1 (επαγγελματικό)</div>
        </div>
      </div>

      <div class="c12">
        <label>Καύσιμο</label>
        <div id="fuelChips" class="chips">
          <div class="chip on" data-fuel="petrol">Βενζίνη</div>
          <div class="chip" data-fuel="diesel">Πετρέλαιο</div>
        </div>
      </div>

      <div class="c12">
        <label>Υβριδισμός</label>
        <div id="hybridChips" class="chips">
          <div class="chip" data-h="mhev">Mild Hybrid</div>
          <div class="chip" data-h="phev">Plug-in Hybrid</div>
          <!-- δεν πατάς τίποτα = none -->
        </div>
      </div>

      <div class="c12">
        <label>Εξοπλισμός</
